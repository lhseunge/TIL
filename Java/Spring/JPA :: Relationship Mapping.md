# 연관관계 매핑

- Entity들은 대부분 다른 Entity들과 관계를 갖는다.
    - 객체는 주소값을 사용해서 관계를 맺고,
    - 테이블은 외래 키를 사용해서 관계를 맺는다.
    - 이 둘은 완전히 다른 특징을 갖는다.
    - **ORM에서 가장 어려운 부분은 객체 연관관계와 테이블 연관관계를 매핑하는 것이다.**

### 연관관계 매핑의 핵심

**회원과 팀 관계일 때**

- 방향 (direction) : [단방향, 양방향]
    - 단방향 : 회원 → 팀 or 팀 → 회원
    - 양방향 : 회원 ↔ 팀
- 다중성 (multiplicity) : [다대일 (n:1), 일대다 (1:n), 일대일 (1:1), 다대다 (n:m)]
    - 여러 회원이 한 팀에 소속된다.
    - 회원과 팀 관계는 다대일 (n:1) 관계.
    - 팀과 회원 관계는 일대다 (1:n) 관계.
- 연관관계 주인 (owner)
    - 객체를 양방향 연관관계로 만들면 연관관계의 주인을 정해야 한다.

# 단방향 연관관계

연관관계 중에선 다대일 단방향 관계를 가장 먼저 이해해야한다.

- 회원은 하나의 팀에만 소속될 수 있다.
- 회원과 팀은 다대일 관계이다.

![대대일 연관 관계 | 다대일 (N : 1), 단방향](attachment:961da0e7-9ea6-44a7-b43c-ecddf5dcc34b:image.png)

대대일 연관 관계 | 다대일 (N : 1), 단방향

- 객체 연관관계
    - 회원 객체는 Member.team 필드로 팀 객체와 연관관계를 맺는다.
    - 회원 객체와 팀 객체는 **단방향 관계**이다.
        - 회원은 Member.team 필드를 통해서 팀을 알 수 있지만 반대로 팀은 회원을 알 수 없다.
        - member.getTeam()을 통해 Team 조회 가능.
        - team은 member를 알 수 없다.
- 테이블 연관관계
    - 회원 테이블 TEAM_ID 외래 키로 테이블과 연관관계를 맺는다.
    - 회원 테이블과 팀 테이블은 **양방향 관계**이다.
        - 회원 테이블의 TEAM_ID 외래 키를 통해서 회원과 팀을 join할 수 있고, 반대도 가능하다.
        - 회원 테이블의 TEAM_ID 키로 MEMBER JOIN TEAM, TEAM JOIN MEMBER 둘 다 가능하다.

![image.png](attachment:810979e4-c822-4a41-8284-2cf7c987b060:image.png)
